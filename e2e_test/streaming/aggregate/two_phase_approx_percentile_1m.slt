statement ok
create table t(v1 int);

# insert 1M positive, uniformly distributed values, 1K buckets
statement ok
insert into t select pow(2,g.v1) from generate_series(-1, 1000) g(v1) join (select 1 from generate_series(1, 1000)) h(v1) on 1=1;

# insert 1M negative, uniformly distributed values, 1K buckets
statement ok
insert into t select -pow(2,g.v1) from generate_series(-1, 1000) g(v1) join (select 1 from generate_series(1, 1000)) h(v1) on 1=1;

statement ok
create materialized view m1 as select approx_percentile(0.5, 0.01) within group (order by v1) from t;

statement ok
drop table t cascade;